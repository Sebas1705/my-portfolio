---
import type { Language, PersonalInfo } from '@/domain';
import { translate } from '@/domain';
import Section from './common/Section.astro';
import LanguageSelector from './LanguageSelector.astro';
import ThemeToggle from './ThemeToggle.astro';

interface Props {
    lang: Language;
    personalInfo: PersonalInfo;
}

const { lang, personalInfo } = Astro.props;

import { InMemoryAboutLabelsRepository } from '@/data';
import { GetAboutLabelsUseCase } from '@/domain';

const aboutLabels = await new GetAboutLabelsUseCase(new InMemoryAboutLabelsRepository()).execute();
---

<Section id="home" class="relative overflow-hidden min-h-[calc(100vh-2rem)] flex items-center py-32 md:py-40">
    <div class="absolute inset-0 pointer-events-none z-0">
        <div class="hero-bg hero-bg-1"></div>
        <div class="hero-bg hero-bg-2"></div>
    </div>

    <div class="relative z-10 w-full">
        <div class="absolute inset-x-0 top-5 flex justify-between px-4 sm:px-6 z-20 pointer-events-auto">
            <div class="flex items-center gap-2">
                <LanguageSelector currentLang={lang} />
            </div>
            <div class="flex items-center gap-2">
                <ThemeToggle />
            </div>
        </div>

        <div class="max-w-4xl mx-auto px-4 text-center">
            <div class="w-full fade-in bg-cover bg-center rounded-2xl shadow-2xl border-2 border-indigo-600 overflow-hidden" style={`background-image: url(${personalInfo.profileImage}); min-height: 16rem;`}>
                <div class="profile-overlay p-6 md:p-10 flex flex-col justify-end md:justify-center text-center md:text-right md:w-1/2 md:absolute md:inset-y-0 md:right-0 md:left-auto">
                    <span class="inline-block px-4 py-1.5 bg-gradient-to-r from-indigo-500 to-emerald-500 text-white font-bold uppercase tracking-wider rounded-full shadow-lg mb-4 self-center md:self-end">{translate(aboutLabels.greeting, lang)}</span>
                    <h1 class="m-0 text-white font-extrabold text-[clamp(2rem,6vw,3rem)] leading-tight drop-shadow-lg">
                        <span class="inline sm:hidden">{personalInfo.name_short}</span>
                        <span class="hidden sm:inline md:hidden">{personalInfo.name_medium}</span>
                        <span class="hidden md:inline lg:hidden">{personalInfo.name_long}</span>
                        <span class="hidden lg:inline">{personalInfo.name}</span>
                    </h1>
                    <p class="text-white/90 font-semibold text-[clamp(1rem,3vw,1.25rem)] mt-2">{translate(personalInfo.title, lang)}</p>

                    <p class="text-white/90 mt-4 max-w-[60ch] mx-auto md:mx-0">{translate(personalInfo.bio, lang)}</p>
                </div>
            </div>
        </div>
    </div>
</Section>

<style>
    /* Fondos radiales grandes y animaciones: conservados en CSS por facilidad */
    .hero-bg { position: absolute; filter: blur(90px); opacity: 0.65; pointer-events: none; z-index: 0; }
    .hero-bg-1 { width: 420px; height: 420px; background: radial-gradient(circle at 30% 30%, rgba(59, 130, 246, 0.35), transparent 55%); top: -80px; left: -80px; }
    .hero-bg-2 { width: 520px; height: 520px; background: radial-gradient(circle at 70% 60%, rgba(16, 185, 129, 0.28), transparent 55%); bottom: -120px; right: -120px; }

    .profile-overlay { position: relative; }
    @media (min-width: 768px) { .profile-overlay { top:0; right:0; bottom:0; left:auto; width:50%; background: linear-gradient(to left, rgba(0,0,0,0.95) 0%, rgba(0,0,0,0.75) 70%, transparent 100%); } }

    .fade-in { animation: fadeIn 600ms ease forwards; opacity: 0; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(6px); } to { opacity: 1; transform: translateY(0); } }
</style>
